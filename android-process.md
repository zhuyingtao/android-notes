## Android 进程

正常情况下，一个 apk 启动后只会运行在一个进程中，其进程名为 apk 的包名，所有的组件都会在这个进程中运行。

但是如果需要将某些组件运行在单独的进程中，就需要`android:process`属性了。我们可以给android的组件设置`android:process`属性来使其运行在指定的进程中。

- AndroidMantifest.xml中的activity、service、receiver和provider均支持`android:process`属性
- 设置该属性可以使每个组件均在各自的进程中运行，或者使一些组件共享一个进程
- AndroidMantifest.xml中的application元素也支持`android:process`属性，可以修改应用程序的默认进程名（默认值为包名）

#### 为何使用多进程

- 分散内存的占用

  Android系统对每个应用进程的内存占用是有限制的，而且占用内存越大的进程，通常被系统杀死的可能性越大。让一个组件运行在单独的进程中，可以减少主进程所占用的内存，避免OOM问题，降低被系统杀死的概率

- 实现多模块 

  当我们的应用开发越来越大，模块越来越多，团队规模也越来越大，协作开发也是个很麻烦的事情。项目解耦，模块化，是这阶段的目标。通过模块解耦，开辟新的进程，独立的JVM，来达到数据解耦目的。模块之间互不干预，团队并行开发，责任分工也明确。

- 子进程崩溃，主进程可以继续工作

  如果子进程因为某种原因崩溃了，不会直接导致主程序的崩溃，可以降低我们程序的崩溃率。

- 主进程退出，子进程可以继续工作

  即使主进程退出了，我们的子进程仍然可以继续工作，假设子进程是推送服务，在主进程退出的情况下，仍然能够保证用户可以收到推送消息。

#### 面临的问题

1. 如果`android:process`的值以冒号开头的话，那么该进程就是**私有进程**，以小写字母开头，那么就是公有进程。

2. 多进程 Application 的多次重建

   思路：判断是否为主进程，只有主进程的时候才执行下面的操作。

3. 静态成员的失效

4. 文件共享问题



